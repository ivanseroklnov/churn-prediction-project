# churn-prediction-project
# Telecom Customer Churn Prediction

## Задача
Прогнозирование оттока клиентов для телекоммуникационной компании.  
Задача бинарной классификации:  
- 0 - Остался  
- 1 - Отток клиентов  

Датасет несбалансирован: отток клиентов составил ≈ 28%.

---

## Цель
Build an accurate and interpretable ML model to identify customers with a high probability of churn and analyze key churn drivers.

---

## Данные
**Source:** Telecom Customer Churn Dataset (Maven Analytics)
https://www.kaggle.com/datasets/shilongzhuang/telecom-customer-churn-by-maven-analytics/data

---
## Краткое резюме
В качестве максимизируемой метрики выбрал PR-AUC, так как присутствует дисбаланс классов (ушедших клиентов ~28% от всех клиентов). Соответственно нужен баланс между recall и precision, который будет обеспечен как раз таки максимальным PR-AUC. Если максимизировать ROC-AUC, есть риск, что модель будет иметь высокий ROC-AUC за счет хорошего распознавания Stayed клиентов (класс = 0), наша же задача - находить Churned клиентов (класс = 1)

**Baseline**: LogisticRegression.

**Метрики Baseline модели**:
accuracy = 0.84
precision = 0.7
recall = 0.74
f1-score = 0.72
ROC-AUC = 0.905
PR-AUC = 0.778

Были рассмотрены SVC, RandomForestClassifier, LGBMClassifier. Лучшей моделью оказался CatBoostClassifier.

Итоговая модель: **CatBoostClassifier**.


**Признаки**: 'Gender', 'Age', 'Married', 'Number of Dependents', 'Number of Referrals', 'Tenure in Months', 'Phone Service',  'Avg Monthly Long Distance Charges', 'Multiple Lines', 'Internet Service', 'Contract', 'Paperless Billing', 'Payment Method',  'Monthly Charge', 'Total Refunds', 'Total Extra Data Charges',  'monthly_charge / tenure' (считается как частное столбцов 'Monthly Charge' и 'Tenure in Months').

**Выбор порога**:
При пороге 0.35 f1 = 0.77. Наилучший баланс между recall и precision. Универсальный порог.

При пороге 0.2-0.25 модель нацелена на максимизацию recall: выявляется большинство потенциально уходящих клиентов, однако возрастает число ложных срабатываний. Такой порог подходит, если бизнес готов тратить ресурсы на клиентов, которые в итоге не уйдут, ради минимизации пропущенных уходов

При пороге 0.4 - 0.5 модель нацелена на максимизацию precision, но с таким порогом снижается recall. Подходит в том случае, когда ресурсы на удержание ограничены.

**Метрики итоговой модели** (порог = 0.33):
accuracy = 0.86
precision = 0.73
recall = 0.805
f1-score = 0.766
ROC-AUC = 0.931
PR-AUC = 0.865

Интерпретация модели выполнена на обучающей выборке для анализа выученных зависимостей. Для оценки значимости признака - mean(abs(SHAP)), для оценки изменения признака на итоговый прогноз - Partial Dependence Plots (PDP).

**Факторы оттока**:
<img width="1326" height="692" alt="image" src="https://github.com/user-attachments/assets/2d2cd967-1ae4-406f-a2b7-9068732c6961" />

1) Тип контракта - ключевой фактор оттока. Клиенты с помесячной контрактом имеют наибольшую вероятность ухода. Клиенты с двухгодовым контрактом имеют наименьшую  вероятность ухода. Если контракт на 1 год - вероятность уйти несколько выше, чем у клиентов с двухгодичным контрактом.


2) Количество рекомендаций. Клиенты без рекомендаций или с одной рекомендацией имеют повышенную вероятность ухода. Пик приходится на клиентов с одной рекомендацией. Начиная от двух и больше рекомендаций вероятность ухода снижается и продолжает уменьшаться.
<img width="837" height="643" alt="image" src="https://github.com/user-attachments/assets/d1bcda77-f316-4c5d-b8c4-7232e23b4e67" />


3) Срок обслуживания. Клиенты, которые обслуживаются 1 месяц, имеют наибольшую вероятность ухода. Вероятность падает для клиентов со сроком обслуживания от 2 до 4 месяцев, но все равно остается большой. При сроке обслуживания больше ~5 месяцев вероятность ухода падает и держится примерно на одном уровне. 
<img width="832" height="626" alt="image" src="https://github.com/user-attachments/assets/88a4a485-226c-4634-8d71-a230050ccafb" />


4) Количество лиц на иждивении. Клиенты без иждивенцев имеют более высокую вероятность ухода. При наличии от одного до трех иждивенцев вероятность ухода снижается. Клиенты с четырьмя и большим количеством иждевенцев имеют повышенную вероятность ухода, которая растет с количеством иждевенцев. Однако данных для клиентов с четырьмя и более иждевенцами слишком мало, поэтому оценки модели для этого сегмента могут быть ненадежными.
<img width="826" height="622" alt="image" src="https://github.com/user-attachments/assets/cb6f4d58-492b-4dd5-9132-a8d3bf965cca" />


5) Нормированный ежемесячный платёж - отношение текущего месячного платежа к сроку обслуживания клиента. Признак отражает финансовую нагрузку клиента с учётом срока пользования услугами. Чем больше значение, тем больше вероятность, что клиент уйдет. При достижении значения ~22, вероятность ухода не меняется.
<img width="828" height="644" alt="image" src="https://github.com/user-attachments/assets/097e8694-a5fa-47ac-bc5b-712f4c623185" />


6) Ежемесячный платеж за все услуги. Ежемесячный платёж оказывает нелинейное влияние на вероятность оттока. В диапазоне до ~70 единиц рост платежа не приводит к увеличению риска ухода. Однако при превышении данного порога вероятность оттока резко возрастает.
<img width="831" height="641" alt="image" src="https://github.com/user-attachments/assets/82c7cd71-ef4b-433b-8e41-45241f1e32f1" />


Важно разделять логику модели и реальные бизнес-процессы. SHAP-значения и PDP показывают, как модель использует признаки для минимизации ошибки на данных, но не гарантируют наличие прямой причинно-следственной связи в реальности. Выявленные пороги (например, Monthly Charge > 70) следует рассматривать как гипотезы для экспериментальной проверки (A/B тестов), а не как окончательный призыв к действию

Текущая модель опирается на статические срезы данных и не учитывает динамику поведения клиентов во времени. Потенциальное улучшение качества прогнозирования возможно за счёт добавления временных признаков (изменение ежемесячных платежей, рост потребления услуг).
